<!--
title: 如何将Markdown生成html格式的邮件并发送
-->

## 邮件基本配置

在使用之前，你需要配置一下SMTP和发件人的信息，别担心，这一切非常简单，因为`m2m`提供了向导式配置，你只需要在终端键入如下命令：

  m2m setup --mail

然后按照提示一步一步输入即可，是不是超级简单呢

### 邮件配置详解

* `SMTP服务器地址`：请到你的邮件提供商查看帮助或者百度，例如126是`smtp.126.com`，163的是`smtp.163.com`
* `SMTP端口`：一般是465或者25，也有用587的，自行百度或者查看邮件提供商的帮助
* `邮件帐号`：用来发邮件的帐号
* `发件人`：这个和邮件帐号一般是一致的，不同的是，你可能需要在发件人加上自己的名字。例如我的邮件件号是`mail@example.com`，而的姓名是`张全蛋`，那么可以将发件人设置为`张全蛋 <mail@example.com>`。注意姓名和`<`之间的空格，否则会导致邮件发送不成功。当然这项你也可以不填，直接回车就可以了，不填和邮件帐号就是一样的了。
* `默认邮件主题`：如果你也像我一样要写周报，那么这项功能对你很有用，比如说你的默认主题可以设置为`周报-张三 $last_week - $now`，`$last_week`和`$now`两个变量分别表示上周同期和当天。邮件主题还可以在markdown邮件中指定，也可以发邮件的时候指定，完全不用担心现在设置以后改不了。
* `默认收件人`：某些邮件的收件人一般是固定的，比如说周报，默认收件人可以让你解脱这个烦恼，多个收件人请用逗号`,`隔开。收件人也可以在发邮件的时候指定，或者是在markdown文件中指定的。
* `是否使用SSL`：参考邮件提供商的帮助或者百度，一般`465`和`587`的端口都是需要启用`ssl`的，启用请输入`y`，否则输入`n`即可
* `邮箱密码`：你的邮箱密码，你的密码以加密的方式保存在你的电脑上，安全方面请不要担心
* `加密钥匙`：用你的钥匙加密你的密码，这是一种更安全的方式，但带来的问题是每次你发邮件都要输入这个钥匙，可能会比较麻烦，但安全与方便总是冲突的，对吧

## 发送邮件

假定你已经写了一个markdown文件需要发送，你只需要在终端切换到该文件的在的目录，键入`m2m mail`即可将最近修改的markdown以邮件的方式发送出去。

`m2m mail`提供几个参数，如下：

* `-s`或`--subject`：指定邮件主题，命令行参数指定的邮件主题优先级最高
* `-a`或`--addressee`：指定收件人，多个收件人请用英文的逗号`,`隔开
* `--silent`：静默发送，如果没有提供此参数，则会要求你确认才发送，这是为了避免手抖将邮件发给了不该发的人
* `-m`或`--markdown`：指定要发送的markdown文件，可以是相对路径，也可以是绝对路径

## 邮件主题

有三个地方可以设置邮件主题，并且越在后面的优先级越高：

1. 全局配置，即你使用`m2m setup --mail`时设置的默认主题
2. markdown文件的meta值 ，关于meta请参考[Markdown中的meta](./meta.html)
3. 发邮件时提供的参数，如`m2m mail -s`或`m2m mail -subject`

邮件主题提供两个变量，分别是上周`$last_week`和当天`$now`，注意上周是针对当天来说的，也就是说今天向前推7天的时间。

日期的格式默认是`%/Y%m/%d`，即`2016-06-11`这种格式，如果你要更改日期的格式，请到全局配置文件下修改，关于全局配置文件，请参考[配置文件](./config.html)。

## 收件人

与邮件主题一样，你也可以在三个地方设置收件人，并且越在后面的优先级越高：

1. 全局配置，即你使用`m2m setup --mail`时设置的默认收件人
2. markdown文件的meta值 ，关于meta请参考[Markdown中的meta](./meta.html)
3. 发邮件时提供的参数，如`m2m mail -a`或`m2m mail --addressee`

## 如何重置密码

使用`m2m setup --mail-password`即可重置密码，当然也可以使用`m2m setup --mail`，但这个命令会让你重新配置SMTP和发件人信息。

## m2m提供的邮件功能有什么优势

1. 将markdown自动转换为html格式的邮件
2. 如果markdown文件中有图片链接，会自动将图片贴到邮件中，可不是附件哦
3. 免去常用邮件主题和收件人的麻烦
4. 对于写周报的同学来说，你懂的

## FAQS

Q: m2m会不会收集我的密码，安全吗

不会啦，代码是开源的，请自行审查源码。你的密码以加必的方式保存在你的电脑上，如果你还不放心，可以使用钥匙进行加密，这个钥匙是不保存的。

Q: 我需要用钥匙加密我的密码吗

一般情况下，我觉得是不需要的，首先你的电脑应该是比较安全的，其实密码本身是经过加密的。设置了加密钥匙每次发邮件都要你输入，也挺烦人的。